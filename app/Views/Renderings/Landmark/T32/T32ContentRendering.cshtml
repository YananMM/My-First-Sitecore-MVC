
@using Landmark.Classes
@using Landmark.Helper
@using Landmark.Models
@using Sitecore.Data.Items
@model RenderingModel
@{
    SearchHelper helper = new SearchHelper();
    var results = helper.GetSearchResults(Request["value"],Request["type"]);
    List<FilterTypeResults> types = helper.GetFilterTypes(Request["value"]);
    ShoppingHelper shoppingHelper = new ShoppingHelper();
}

 <div class="container">
        <div class="gd-pagetitle">
            <div class="gd-pagetitle-heading">
                <h2>@Html.Sitecore().Field("Page Title").ToString().ToUpper()</h2>
            </div>
              <div  class="gd-search-info">@results.Count search result(s) for <span>"@Request["value"]"</span></div>
              <div  class="gd-search-filter hidden-xs">@Html.Sitecore().Field("Glossary Value",ItemGuids.FilterByItem)
                <ul>
                    <!--<li class="active"><a href="#">ALL</a></li>-->
                @foreach (var type in types)
                {
                    if(Int32.Parse(type.count)>0)
                        {<li><a href="#">@type.value (@type.count)</a></li>}
                }
          </ul>
          </div>
          
        <div class="gd-controls-m visible-xs">
                    <select class="form-control">
                        <option value="#">ALL</option>
                        @foreach (var type in types)
                        {
                            if(Int32.Parse(type.count)>0)
                                {<option value="">@type.value (@type.count)</option>}
                        }
                    </select>
        </div>
          
        </div>
     <div class="gd-search">
         @if (results.Select(item =>item.FilterType == Sitecore.Context.Database.GetItem(ItemGuids.ShoppingFilterType).Fields["Value"].Value).ToList().Count>0)
         {
            <div class="gd-search-heading">
             <h3>@Html.Sitecore().Field("Glossary Value",ItemGuids.StoreDetailsItem)</h3>
         </div>
        }
         
         <div class="gd-search-body">
             <ol>
                 @foreach (var result in results)
                 {
                     if (result.FilterType == Sitecore.Context.Database.GetItem(ItemGuids.ShoppingFilterType).Fields["Value"].Value)
                     {
                         <li>
                             <div class="gd-search-box2">
                                 <div class="row">
                                     <div class="col-sm-9">
                                         <a href="#"><img data-src="@Html.Sitecore().ImageFieldSrc("Brand Image",result.GetItem())"></a>
                                         <h4><a href="#">@Html.Sitecore().Field("Brand Title",result.GetItem())</a></h4>
                                         <p>
                                             @{
                                                    var floor = shoppingHelper.GetShopFloor(result.GetItem());
                                                }
                                             <span class="icomoon-location2"></span>@Html.Sitecore().Field("Area"),@floor["Floor Title"],@floor.Parent["Building Title"]
                                         </p>
                                         <p>
                                             <span class="icomoon-phone"></span>@Html.Sitecore().Field("Contact",result.GetItem())
                                         </p>
                                         <a href="@Html.Sitecore().Field("Official Website Url")" class="gd-search-link-brief">@Html.Sitecore().Field("Glossary Value", ItemGuids.OfficialWebsiteItem)<span class="icomoon-chevron-small-right"></span></a>
                                     </div>
                                     <div class="col-sm-3">
                                         <h5>@Html.Sitecore().Field("Glossary Value", ItemGuids.OpenningHoursItem)</h5>
                                         <p>@Html.Sitecore().Field("Mon-Fri Opening Hours",result.GetItem())<br>
                                            @Html.Sitecore().Field("Sat-Sun Opening Hours",result.GetItem())
                                         </p>
                                     </div>
                                 </div>
                             </div>
                         </li>
                     }
                     else
                     {
                         <li>
                             <div class="gd-search-box">
                                 <h5>@result.FilterType</h5>
                                 <h4><a href="#">@result.PageTitle</a></h4>
                                 <div>@result.GetItem().Statistics.Created.ToString("MMM dd,yyyy")</div>
                             </div>
                         </li>
                     }

                 }
             </ol>
         </div>
     </div>
    </div>
    
